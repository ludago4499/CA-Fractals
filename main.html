<!doctype html>
<html lang="es">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title> Fractals — COordinates </title>
    <style>
        body { font-family: Arial, sans-serif; max-width:720px; margin:40px auto; padding:0 16px; }
        form { display:flex; gap:8px; align-items:end; flex-direction:column; padding:12px; border:1px solid #ddd; border-radius:6px; width:360px; }
        label { display:flex; flex-direction:column; font-size:14px; }
        input[type="number"] { padding:6px 8px; width:140px; }
        .row { display:flex; gap:8px; align-items:flex-end; flex-wrap:wrap; }
        button { padding:8px 12px; }
        ul { margin-top:8px; padding-left:20px; max-height:300px; overflow:auto; }
        h1,h2 { margin:0 0 8px 0; font-size:18px; }
    </style>
</head>
<body>
    <h1> Fractals — Coordinates</h1>

    <form id="formCoords" aria-label="Lista de coordenadas">
        <h2>Add coordinates Tamaulipas</h2>
        <div class="row">
            <label>
                X
                <input id="x" name="x" type="number" step="1" required placeholder="ej. -0.75">
            </label>
            <label>
                Y
                <input id="y" name="y" type="number" step="1" required placeholder="ej. 0.12">
            </label>
        </div>

        <div class="row">
            <button type="submit">Add</button>
            <button type="button" id="clear">Clear</button>
            <button type="button" id="start">Start</button>
        </div>

        <ul id="coordsList" aria-live="polite"></ul>
    </form>

    <script>
        const coords = [];
        const form = document.getElementById('formCoords');
        const inputX = document.getElementById('x');
        const inputY = document.getElementById('y');
        const list = document.getElementById('coordsList');
        const clearBtn = document.getElementById('clear');
        const sendBtn = document.getElementById('start');

        function render() {
            list.innerHTML = '';
            coords.forEach((c, i) => {
                const li = document.createElement('li');
                li.textContent = `${i + 1}. X: ${c.x}, Y: ${c.y}`;
                list.appendChild(li);
            });
        }

        form.addEventListener('submit', e => {
            e.preventDefault();
            const xv = parseFloat(inputX.value);
            const yv = parseFloat(inputY.value);
            if (Number.isFinite(xv) && Number.isFinite(yv)) {
                coords.push({ x: xv, y: yv });
                inputX.value = '';
                inputY.value = '';
                inputX.focus();
                render();
                console.log('Coordenadas:', coords);
            } else {
                alert('Ingrese valores numéricos válidos.');
            }
        });

        clearBtn.addEventListener('click', () => {
            coords.length = 0;
            render();
            inputX.focus();
        });

        sendBtn.addEventListener('click', async () => {
            if (coords.length === 0) { alert('La lista está vacía.'); return; }
            try {
                const res = await fetch('http://localhost:8080/coords', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(coords)
                });
                if (!res.ok) {
                    const txt = await res.text();
                    throw new Error(txt || res.statusText);
                }
                const data = await res.json();
                alert(`Respuesta Julia: ${JSON.stringify(data)}`);
                console.log('Respuesta Julia:', data);
            } catch (err) {
                console.error(err);
                alert('Error al enviar a Julia: ' + err.message);
            }
        });

    </script>
</body>
</html>